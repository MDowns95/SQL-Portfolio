/* In Progress */

/* These are my solutions to the gauntlet of practice problems at https://www.sql-practice.com/
  the practice database is a medical relational database built using SQLite
  the questions range through 17 easy, 23 medium, and 10 hard */

/* Commands covered include: */

/* Easy Questions */

/* Question 1: Show first name, last name, and gender of patients who's gender is 'M' */
SELECT first_name, last_name, gender 
	FROM patients
	WHERE gender IS 'M';
  
/* Question 2: Show first name and last name of patients who does not have allergies. (null) */
SELECT first_name, last_name
	FROM patients
	WHERE allergies is NULL;

/* Question 3: Show first name of patients that start with the letter 'C' */
SELECT first_name
	FROM patients
	WHERE first_name LIKE 'C%';

/* Question 4: Show first name and last name of patients that weight within the range of 100 to 120 (inclusive) */
SELECT first_name, last_name
	FROM patients
	WHERE weight BETWEEN '100' AND '120';

/* Question 5: Update the patients table for the allergies column. 
   If the patient's allergies is null then replace it with 'NKA' */
UPDATE patients
	SET allergies = "NKA"
	WHERE allergies IS NULL;

/* Question 6: Show first name and last name concatinated into one column to show their full name. */
SELECT CONCAT(first_name, " ", last_name)
	FROM patients;

/* Question 7: Show first name, last name, and the full province name of each patient. 
   Example: 'Ontario' instead of 'ON' */
SELECT first_name, last_name, province_name
	FROM patients p
	JOIN provinces pr
		ON p.province_id = pr.province_id;

/* Question 8: Show how many patients have a birth_date with 2010 as the birth year. */
SELECT COUNT(*) 
	FROM patients
	WHERE birth_date LIKE "2010-%";

/* Question 9: Show the first_name, last_name, and height of the patient with the greatest height. */
SELECT first_name, last_name, height
	FROM patients
	ORDER BY height DESC LIMIT 1;

/* Question 10: Show all columns for patients who have one of the following patient_ids: 1,45,534,879,1000 */
SELECT * 
	FROM patients
	WHERE patient_id IS "1"
		OR patient_id IS "45"
		OR patient_id IS "534"
		OR patient_id IS "879"
		OR patient_id IS "1000";

/* Question 11: Show the total number of admissions */
SELECT COUNT(*) admission_date
	FROM admissions;

/* Question 12: Show all the columns from admissions where the patient was admitted and discharged on the same day. */
SELECT * FROM admissions
	WHERE admission_date = discharge_date;

/* Question 13: Show the total number of admissions for patient_id 579. */
SELECT patient_id, COUNT(*) AS total_admissions
	FROM admissions
	WHERE patient_id IS "573";

/* Question 14: Based on the cities that our patients live in, show unique cities that are in province_id 'NS'? */
SELECT DISTINCT city
	FROM patients
	WHERE province_id IS "NS";

/* Question 15: Write a query to find the first_name, last name and birth date of patients who have height more than 160 and weight more than 70 */
SELECT first_name, last_name, birth_date
	FROM patients
	WHERE height > "160" 
		AND weight > "70";

/* Question 16: Write a query to find list of patients first_name, last_name, and allergies from Hamilton where allergies are not null */
SELECT first_name, last_name, allergies
	FROM patients
	WHERE city IS "Hamilton"
		AND allergies IS NOT NULL
		AND allergies IS NOT "NKA";

/* Question 17: Based on cities where our patient lives in, write a query to display the list of unique city starting with a vowel (a, e, i, o, u). 
   Show the result order in ascending by city. */
SELECT city
	FROM patients
	WHERE city LIKE 'A%'
    		OR city LIKE 'E%'
    		OR city LIKE 'I%'
    		OR city LIKE 'O%'
    		OR city LIKE 'U%'
	GROUP BY city
	ORDER BY city ASC;

/* Medium Questions */


/* Question 1: Show unique birth years from patients and order them by ascending. */
SELECT distinct YEAR(birth_date)
	FROM patients
	ORDER BY birth_date;

/* Question 2: Show unique first names from the patients table which only occurs once in the list.
  For example, if two or more people are named 'John' in the first_name column then don't include their name in the output list. 
  If only 1 person is named 'Leo' then include them in the output. */
SELECT first_name
	FROM patients
	GROUP BY first_name
	HAVING COUNT(*) = 1;

/* Question 3: Show patient_id and first_name from patients where their first_name start and ends with 's' and is at least 6 characters long. */
SELECT patient_id, first_name
	FROM patients
	WHERE first_name LIKE "s____%s";

/* Question 4: Show patient_id, first_name, last_name from patients whos diagnosis is 'Dementia'.
   Primary diagnosis is stored in the admissions table */
SELECT p.patient_id, first_name, last_name
	FROM patients p
	JOIN admissions a
		ON p.patient_id = a.patient_id
	WHERE primary_diagnosis IS "Dementia";

/* Question 5: Display every patient's first_name. 
   Order the list by the length of each name and then by alphabetically */
SELECT first_name
	FROM patients
	ORDER by LEN(first_name), first_name;

/* Question 6: Show the total amount of male patients and the total amount of female patients in the patients table.
   Display the two results in the same row. */
SELECT 
	(SELECT COUNT(*) FROM patients WHERE gender IS "M") AS male_count, 
	(SELECT count(*) FROM patients WHERE gender IS "F") AS female_count;

/* Question 7: Show first and last name, allergies from patients which have allergies to either 'Penicillin' or 'Morphine'. 
   Show results ordered ascending by allergies then by first_name then by last_name. */
SELECT first_name, last_name, allergies
	FROM patients
	WHERE allergies IS "Penicillin"
		OR allergies IS "Morphine"
	ORDER BY allergies, first_name, last_name;

/* Question 8: Show patient_id, diagnosis from admissions. 
   Find patients admitted multiple times for the same diagnosis. */
SELECT patient_id, primary_diagnosis
	FROM admissions
	GROUP BY patient_id, primary_diagnosis
	HAVING COUNT(*) > 1;

/* Question 9: Show the city and the total number of patients in the city.
   Order from most to least patients and then by city name ascending. */
SELECT city, count(first_name) AS num_patients 
	FROM patients
	GROUP BY city
	ORDER BY num_patients DESC;

/* Question 10: Show first name, last name and role of every person that is either patient or doctor.
The roles are either "Patient" or "Doctor"
SELECT first_name, last_name, "Patient" AS role
	FROM patients
UNION ALL 
SELECT first_name, last_name, "Physician" AS role
	FROM physicians;

/* Question 11: Show all allergies ordered by popularity. Remove NULL values from query. */
SELECT allergies, COUNT(*) AS total_diagnosis
	FROM patients
	WHERE allergies IS NOT NULL 
		AND allergies IS NOT "NKA"
	GROUP BY allergies
	ORDER BY count(*) DESC;

/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Hard Questions */


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


/* Question 


